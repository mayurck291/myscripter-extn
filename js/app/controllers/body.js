// Generated by CoffeeScript 1.3.3
(function() {
  var BodyController, MonkeyWrench,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  MonkeyWrench = angular.module('MonkeyWrench');

  BodyController = (function() {

    BodyController.$inject = ['$scope', '$routeParams', 'Baazar', 'GPauth', 'Alert'];

    function BodyController(scope, routeParams, Baazar, gp, Alert) {
      var _this = this;
      this.scope = scope;
      this.routeParams = routeParams;
      this.Baazar = Baazar;
      this.gp = gp;
      this.Alert = Alert;
      this.signOut = __bind(this.signOut, this);

      this.signIn = __bind(this.signIn, this);

      this.getUserInfo = __bind(this.getUserInfo, this);

      this.scope.alert = this.Alert.bind();
      this.scope.signIn = this.signIn;
      this.scope.signOut = this.signOut;
      this.gp.load().then(function() {
        return _this.getUserInfo();
      }, function() {
        _this.scope.user = null;
        _this.scope.signedIn = false;
        return console.log("User not signed in");
      });
      return;
    }

    BodyController.prototype.getUserInfo = function() {
      var _this = this;
      return this.gp.getUserInfo().then(function(user) {
        _this.scope.user = user;
        return _this.scope.signedIn = true;
      }, function() {
        return _this.gp.signOut();
      });
    };

    BodyController.prototype.signIn = function() {
      var _this = this;
      console.log(this.gp);
      console.log("signing in .....");
      this.Alert.warning("Loading...........:)");
      this.gp.signIn().then(function() {
        return _this.getUserInfo();
      }, function(error) {
        return console.log(error);
      });
    };

    BodyController.prototype.signOut = function() {
      var _this = this;
      console.log("signing out.....");
      this.gp.signOut().then(function() {
        return console.log("out");
      }, function() {
        return console.log("not out");
      });
      this.scope.user = null;
      this.scope.signedIn = false;
    };

    return BodyController;

  })();

  MonkeyWrench.controller('BodyController', BodyController);

}).call(this);
